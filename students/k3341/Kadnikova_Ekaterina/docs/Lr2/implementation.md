## Цель задания

Создать веб-приложение на Django для управления турами, где пользователи могут регистрироваться, просматривать список туров, бронировать их, оставлять отзывы, а администратор — подтверждать бронирования. Также на странице каждого тура должна отображаться средняя оценка (рейтинг), рассчитанная на основе отзывов.

## Реализация

### Модели данных

Модели данных разработаны для хранения информации о турах, агентствах, бронированиях и отзывах. Основные модели:

- **TourAgency**: хранит информацию о турагентстве (название, описание, сайт).
- **Tour**: информация о туре, включая описание, даты начала и конца, условия оплаты, количество мест и средний рейтинг.
- **Booking**: представляет бронирования. Поле `is_confirmed` позволяет отслеживать, подтверждено ли бронирование.
- **Review**: позволяет пользователям оставлять отзывы на подтверждённые бронирования с текстом и оценкой.

### Основной функционал

#### 1. **Регистрация и аутентификация пользователей**
   - Пользователи могут регистрироваться, входить и выходить из аккаунта. Доступ к бронированию и отзывам возможен только для зарегистрированных пользователей.
   - Настроены формы `login`, `register` с использованием встроенных механизмов Django для аутентификации.

#### 2. **Просмотр и бронирование туров**
   - **Список туров** (`tour_list`): отображает все доступные туры. Каждый тур представлен в виде карточки с базовой информацией и ссылкой на детальную страницу.
   - **Детальная страница тура** (`tour_detail`): показывает полное описание тура, среднюю оценку и список отзывов. Кнопка для бронирования тура видна зарегистрированным пользователям.

#### 3. **Система отзывов**
   - Пользователи могут оставлять отзывы, только если их бронирование подтверждено. Поле `average_rating` в модели `Tour` динамически обновляется при добавлении, редактировании и удалении отзывов.
   - Средний рейтинг тура отображается на странице `tour_detail`. Если отзывов нет, выводится сообщение, что отзывы отсутствуют.

#### 4. **Подтверждение бронирований администратором**
   - Администраторы подтверждают бронирования в консоли Django-admin, и при этом автоматически уменьшается количество доступных мест в туре.
   - Для этого в модели `Booking` переопределён метод `save`, который проверяет, что бронирование ещё не было подтверждено, и только тогда уменьшает число мест.

### Настройка прав и разграничение доступа

Для разграничения доступа:
- Пользователи могут видеть свои бронирования и оставлять отзывы только по подтверждённым турам.
- Администраторы могут подтверждать бронирования через Django-admin.

### Запуск

1. **Создание суперпользователя** (для доступа к админ-панели):
   ```bash
   python manage.py createsuperuser
   ```

2. **Запуск сервера**:
   ```bash
   python manage.py runserver
   ```

### Руководство по использованию

- **Просмотр списка туров**: Перейдите на главную страницу для просмотра всех доступных туров.
- **Регистрация и вход**: Зарегистрируйтесь и войдите в систему, чтобы получить доступ к бронированию и отзывам.
- **Бронирование**: Откройте детальную страницу тура и нажмите на кнопку «Book Now». Администратор должен подтвердить бронирование через админ-панель.
- **Оставление отзыва**: После подтверждения бронирования вы можете оставить отзыв на странице тура.
- **Подтверждение бронирования**: Подтвердить бронь пользователем тура может только администратор в панели администратора, проставив чекбокс is confirmed в соответствующей записи в таюлице Booking.